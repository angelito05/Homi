<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear Publicaci√≥n | Homi</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='CSS/homi.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='CSS/publicaciones.css') }}">
    
    <style>
        .fila-formulario { display: flex; gap: 15px; margin-bottom: 10px; }
        .columna-formulario { flex: 1; }
        .error-texto { color: #dc3545; font-size: 0.85em; margin-top: 2px; display: block; }
    </style>
</head>
<body>

    <div class="pub-container">
        <div class="pub-header">
            <div class="homi-logo">
                <span class="logo-text">Homi</span>
            </div>
            <div class="menu-icon">&#9776;</div>
        </div>

        <form action="/crear-publicacion" method="POST" enctype="multipart/form-data">
            {{ form.csrf_token }}

            <div class="pub-grid">
                
                <div class="left-col">
                    <label class="label-titulo">Detalles de la Publicaci√≥n</label>
                    
                    {{ form.titulo(class="homi-input", placeholder="T√≠tulo de la propiedad (Ej: Casa en el centro)") }}
                    {% for error in form.titulo.errors %}<span class="error-texto">{{ error }}</span>{% endfor %}
                    
                    {{ form.descripcion(class="homi-input homi-textarea", style="height: 100px;", placeholder="Descripci√≥n detallada...") }}

                    <div class="fila-formulario">
                        <div class="columna-formulario">
                            <label>Operaci√≥n</label>
                            {{ form.tipo_operacion(class="homi-input") }}
                        </div>
                        <div class="columna-formulario">
                            <label>Tipo Inmueble</label>
                            {{ form.tipo_propiedad(class="homi-input") }}
                        </div>
                    </div>

                    <label>Precio ($)</label>
                    {{ form.precio(class="homi-input", placeholder="Ej: 1500000") }}

                    <label class="label-titulo" style="margin-top: 15px;">Caracter√≠sticas</label>
                    <div class="fila-formulario">
                        <div class="columna-formulario">
                            <label>Hab.</label>
                            {{ form.numero_habitaciones(class="homi-input") }}
                        </div>
                        <div class="columna-formulario">
                            <label>Ba√±os</label>
                            {{ form.numero_banos(class="homi-input") }}
                        </div>
                        <div class="columna-formulario">
                            <label>m¬≤</label>
                            {{ form.superficie_m2(class="homi-input") }}
                        </div>
                    </div>

                    <label class="label-titulo" style="margin-top: 15px;">Direcci√≥n</label>
                    {{ form.calle(class="homi-input", placeholder="Calle") }}
                    
                    <div class="fila-formulario">
                        {{ form.numero_ext_int(class="homi-input columna-formulario", placeholder="N√∫m. Ext/Int") }}
                        {{ form.codigo_postal(class="homi-input columna-formulario", placeholder="C.P.") }}
                    </div>
                    <div class="fila-formulario">
                        {{ form.colonia(class="homi-input columna-formulario", placeholder="Colonia") }}
                        {{ form.ciudad(class="homi-input columna-formulario", placeholder="Ciudad") }}
                    </div>

                    <div class="owner-section">
                        <img src="{{ url_for('static', filename=propietario.foto_perfil) }}" class="owner-avatar" onerror="this.src='https://cdn-icons-png.flaticon.com/512/847/847969.png'">
                        <div>
                            <strong>Propietario:</strong><br><span>{{ propietario.nombre }}</span>
                        </div>
                    </div>

                    {{ form.submit(class="btn-publicar") }}
                </div>

                <div class="right-col">
                    
                    <div class="carousel-container">
                        {{ form.foto1(id="file-1", hidden=True, onchange="previewCarouselImage(this, 1)") }}
                        {{ form.foto2(id="file-2", hidden=True, onchange="previewCarouselImage(this, 2)") }}
                        {{ form.foto3(id="file-3", hidden=True, onchange="previewCarouselImage(this, 3)") }}
                        {{ form.foto4(id="file-4", hidden=True, onchange="previewCarouselImage(this, 4)") }}
                        {{ form.foto5(id="file-5", hidden=True, onchange="previewCarouselImage(this, 5)") }}

                        <div class="carousel-slide active" onclick="document.getElementById('file-1').click()">
                            <button type="button" class="btn-delete" onclick="deleteImage(event, 1)">üóëÔ∏è</button>
                            <div class="placeholder-content" id="ph-1"><span style="font-size: 40px;">üì∏</span><br>Foto Principal</div>
                            <img src="" class="slide-img" id="img-1" style="display:none;">
                        </div>
                        
                        <div class="carousel-slide" onclick="document.getElementById('file-2').click()">
                             <div class="placeholder-content" id="ph-2"><span>‚ûï</span><br>Foto 2</div>
                             <img src="" class="slide-img" id="img-2" style="display:none;">
                        </div>
                        <div class="carousel-indicators">
                            <span class="dot active"></span>
                            <span class="dot"></span>
                            <span class="dot"></span>
                            <span class="dot"></span>
                            <span class="dot"></span>
                        </div>
                    </div>

                    <label class="label-titulo">Ubicaci√≥n (Selecciona en el mapa)</label>
                    <div id="map" style="height: 300px; width: 100%; border-radius: 10px;"></div>
                    
                    {{ form.latitud(id="lat") }}
                    {{ form.longitud(id="lng") }}
                </div>
            </div>
        </form>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script src="{{ url_for('static', filename='JS/publicaciones.js') }}?v=2"></script>

    </body>
</html>